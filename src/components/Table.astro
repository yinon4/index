---
import {
  createTable,
  createColumnHelper,
  getCoreRowModel,
} from "@tanstack/table-core";

interface Props<T> {
  data: T[];
}

const { data } = Astro.props;

const columnHelper = createColumnHelper<(typeof data)[0]>();

const tColumns = Object.keys(data[0]).map((key: string) =>
  columnHelper.accessor(key, {
    header: key,
    cell: (info) => info.getValue(),
  }),
);

const table = createTable({
  columns: tColumns,
  data,
  getCoreRowModel: getCoreRowModel(),
  onStateChange: () => {},
  state: {},
  renderFallbackValue: () => null,
});
---

<table>
  <thead>
    <tr>
      {table.options.columns.map((header) => <th>{header.header}</th>)}
    </tr>
  </thead>
  <tbody>
    {
      table.options.data.map((row) => (
        <tr>
          {Object.keys(row).map((key) => (
            <td>{row[key]}</td>
          ))}
        </tr>
      ))
    }
  </tbody>
</table>
