---
import PostLayout from "../../../layouts/Post.astro";
import books from "../../../data/books.json";
import { BookType } from "../../../types";
import { z } from "astro/zod";
import {
  getAuthors,
  getRating,
  getTags,
  getTitle,
} from "../../../functions/books";

const BooksType = z.array(BookType);
type Book = z.infer<typeof BookType>;

BooksType.parse(books);

books.sort((a, b) => a.title.localeCompare(b.title));
---

<PostLayout title="books" links={[]}>
  <table>
    <thead>
      <tr>
        <th>title</th>
        <th>author</th>
        <th>tags</th>
        <th>rating</th>
      </tr>
    </thead>
    <tbody>
      {
        books.map((book: Book) => (
          <tr>
            <td>{getTitle(book)}</td>
            <td>{getAuthors(book)}</td>
            <td>{getTags(book).join(" ")}</td>
            <td>{getRating(book)}</td>
          </tr>
        ))
      }
    </tbody>
  </table>
</PostLayout>
